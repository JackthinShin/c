<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title id="pageTitle">在线 C 编译器 · 使用指南与介绍</title>
  <meta name="description" content="零配置、开箱即用的在线 C 编译器：浏览器内编辑、自动缩进、运行输出、另存为下载、明暗主题切换。" />
  <meta property="og:title" content="在线 C 编译器" />
  <meta property="og:description" content="零配置、开箱即用的在线 C 编译器：浏览器内编辑、自动缩进、运行输出、另存为下载、明暗主题切换。" />
  <meta property="og:type" content="website" />
  <meta name="theme-color" content="#0b0c0d" />
  <link rel="manifest" href="./manifest.webmanifest" />
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Crect x='6' y='6' width='52' height='52' rx='12' fill='%232563eb'/%3E%3Cpath d='M30 18 L18 32 L30 46 M34 18 L46 32 L34 46' fill='none' stroke='%23fff' stroke-width='6' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E" type="image/svg+xml" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root{
      --bg:#0b0c0d; --panel:#0f1113; --text:#dbe9ff; --muted:#9aa4ad; --accent:#2563eb; --radius:14px; --shadow:0 10px 30px rgba(0,0,0,.5);
    }
  .light{ --bg:#f3f6fb; --panel:#ffffff; --text:#0b1220; --muted:#4b5563; --accent:#2563eb; --shadow:0 8px 28px rgba(0,0,0,.08); }
    *{box-sizing:border-box} body{margin:0;background:var(--bg);color:var(--muted);font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial}
    a{color:var(--accent);text-decoration:none}
    .page{max-width:1040px;margin:0 auto;padding:24px}
    .hero{background:linear-gradient(180deg,rgba(255,255,255,.03),transparent);border-radius:var(--radius);box-shadow:var(--shadow);padding:32px;margin-top:18px}
    .hero h1{margin:0 0 10px;color:var(--text);font-size:28px}
    .hero p{margin:0;color:var(--muted);line-height:1.65}
    .cta{display:flex;gap:12px;flex-wrap:wrap;margin-top:18px}
    .btn{border:1px solid rgba(255,255,255,.06);background:transparent;color:var(--text);padding:10px 14px;border-radius:10px;cursor:pointer;display:inline-flex;align-items:center;gap:8px}
    .btn.primary{background:var(--accent);color:#fff;border:0}
    .grid{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:16px;margin-top:22px}
    .card{background:var(--panel);border-radius:12px;padding:16px;box-shadow:var(--shadow)}
    .card h3{margin:0 0 8px;color:var(--text);font-size:16px}
    .card p{margin:0;color:var(--muted);line-height:1.7}
    .section{margin-top:28px;background:var(--panel);border-radius:12px;box-shadow:var(--shadow);padding:20px}
    .section h2{margin:0 0 12px;color:var(--text);font-size:20px}
    .list{margin:0;padding-left:18px;color:var(--muted);line-height:1.8}
    .footer{display:flex;align-items:center;justify-content:space-between;margin:32px 0 14px;color:var(--muted)}
    .footer .brand{color:var(--muted)}
    .theme-toggle{position:fixed;right:16px;bottom:16px;border-radius:10px;background:var(--panel);border:1px solid rgba(0,0,0,.1);padding:10px 12px;color:var(--text);box-shadow:var(--shadow);cursor:pointer}
    @media (max-width:960px){ .grid{grid-template-columns:1fr} }
  </style>
</head>
<body>
  <div class="page">
    <div class="hero" id="hero">
      <h1 id="heroTitle"><i class="fas fa-code"></i> 在线 C 编译器</h1>
      <p id="heroDesc">零配置、开箱即用的在线 C 语言编译/运行环境：浏览器中即可编写与运行 C 代码，支持智能自动缩进、美观主题、复制与另存为下载；运行优先调用 Wandbox，若在线失败再回退本地模拟；离线状态将提示不可运行，避免误导。</p>
      <div class="cta">
        <a class="btn primary" id="ctaExperience" href="./index.html"><i class="fas fa-play"></i> 立即体验</a>
        <a class="btn" id="ctaChangelog" href="./CHANGELOG.md" target="_blank"><i class="fas fa-book"></i> 查看更新日志</a>
        <a class="btn" id="ctaHelp" href="#help"><i class="fas fa-circle-question"></i> 使用帮助</a>
      </div>
    </div>

    <div class="grid">
      <div class="card" id="cardCore"><h3><i class="fas fa-bolt"></i> 核心特性</h3><p id="coreDesc">Monaco 编辑器、自动缩进（纯 JS）、撤销/重做、复制、另存为下载、明亮/暗色主题、侧栏输入输出与运行状态显示。</p></div>
      <div class="card" id="cardIndent"><h3><i class="fas fa-wand-magic-sparkles"></i> 智能缩进</h3><p id="indentDesc">支持 if/for/while 单行体、do...while、switch/case、字符串/注释/预处理指令，避免常见误缩进。</p></div>
      <div class="card" id="cardPrivacy"><h3><i class="fas fa-shield-halved"></i> 数据与隐私</h3><p id="privacyDesc">编辑内容保存在浏览器本地（localStorage）。另存为将下载到你的设备；提交到 Wandbox 的代码仅用于编译运行。</p></div>
    </div>

    <div id="advantages" class="section">
  <h2 id="advTitle"><i class="fas fa-star"></i> 最大优势</h2>
      <ol class="list">
  <li class="advItem" data-i18n-key="adv1">方便快捷，无需下载，随时可用</li>
  <li class="advItem" data-i18n-key="adv2">可以一键复制，方便 OJ 做题提交</li>
  <li class="advItem" data-i18n-key="adv3">关闭标签页后代码不会丢失</li>
  <li class="advItem" data-i18n-key="adv4">可以一键自动缩进，解决缩进烦恼</li>
  <li class="advItem" data-i18n-key="adv5">界面美观，堪称完美，绝对细节</li>
  <li class="advItem" data-i18n-key="adv6">安全考量，无需担心代码泄漏</li>
      </ol>
    </div>

    <div id="more-advantages" class="section">
  <h2 id="moreAdvTitle"><i class="fas fa-gem"></i> 更多优势</h2>
      <ul class="list">
    <li class="moreAdvItem" data-i18n-key="madv1"><b>纯前端 · 零安装</b>：无需登录与插件，打开即用；PWA 支持可安装到桌面，图标为自适应 maskable。</li>
    <li class="moreAdvItem" data-i18n-key="madv2"><b>离线友好</b>：首次加载后，页面、图标与基础脚本会被缓存；断网仍可编辑、保存与分享链接（运行会提示当前不可执行）。</li>
    <li class="moreAdvItem" data-i18n-key="madv3"><b>极速交互</b>：Monaco 编辑器配合本地持久化，撤销/重做、复制、自动缩进响应迅速。</li>
    <li class="moreAdvItem" data-i18n-key="madv4"><b>易用细节</b>：文件名与脏标记、主题记忆、移动端 I/O 面板切换、动画和阴影统一，使用过程顺滑。</li>
    <li class="moreAdvItem" data-i18n-key="madv5"><b>可靠最小集</b>：默认不上传任何代码，只有点击“运行”时才调用远端；失败会回退到本地模拟，保障体验。</li>
    <li class="moreAdvItem" data-i18n-key="madv6"><b>可分享与可复现</b>：支持将代码压缩进链接（URL hash），一键复制给同学/同事，对方打开即还原。</li>
      </ul>
    </div>

    <div id="help" class="section">
  <h2 id="helpTitle"><i class="fas fa-circle-question"></i> 使用帮助</h2>
      <ol class="list">
  <li class="helpItem" data-i18n-key="help1">打开 <a href="./index.html">在线编译器</a>，在编辑区域编写 C 代码。</li>
  <li class="helpItem" data-i18n-key="help2">左侧“输入 (stdin)”填入你的标准输入（可选）。</li>
  <li class="helpItem" data-i18n-key="help3">点击底部“运行”按钮：在线优先通过 Wandbox 编译/运行；若在线失败自动回退本地模拟；离线则弹窗提示不可运行。</li>
  <li class="helpItem" data-i18n-key="help4">需要排版可点击“自动缩进”；复制代码用“复制”，保存到本地用“另存为”。</li>
  <li class="helpItem" data-i18n-key="help5">切换“主题”可在明亮/暗色间切换；撤销/重做按钮会在可用时自动启用。</li>
      </ol>
      <p style="margin-top:8px">注意：若 Wandbox 暂不可用，输出区会提示已回退到“本地模拟”；若离线，将弹窗说明不可执行。</p>
    </div>

    <div id="shortcuts" class="section">
  <h2 id="shortcutTitle"><i class="fas fa-keyboard"></i> 键盘快捷键</h2>
      <ul class="list">
  <li class="shortcutItem" data-i18n-key="sc1">运行：Ctrl/Cmd + Enter</li>
  <li class="shortcutItem" data-i18n-key="sc2">自动缩进：Ctrl/Cmd + I</li>
  <li class="shortcutItem" data-i18n-key="sc3">另存为：Ctrl/Cmd + S</li>
  <li class="shortcutItem" data-i18n-key="sc4">切换行注释：Ctrl/Cmd + /</li>
  <li class="shortcutItem" data-i18n-key="sc5">命令面板：Ctrl/Cmd + Shift + P（Esc 关闭）</li>
      </ul>
    </div>

    <div id="share" class="section">
  <h2 id="shareTitle"><i class="fas fa-share-nodes"></i> 分享与协作</h2>
      <ul class="list">
  <li class="shareItem" data-i18n-key="share1">支持一键分享：将代码压缩进链接（URL hash），复制给同学/同事，对方打开即可还原。</li>
  <li class="shareItem" data-i18n-key="share2">分享增强：可选择是否包含“输入 (stdin)”与“测试用例”，便于复现实验环境；仅包含代码时使用精简链接。</li>
  <li class="shareItem" data-i18n-key="share3">打开分享链接后，页面会自动还原代码；若包含输入/用例，也会同步到 I/O 或测试面板中。</li>
      </ul>
    </div>

    <div class="section">
  <h2 id="faqTitle"><i class="fas fa-list-check"></i> 常见问题（FAQ）</h2>
      <ul class="list">
  <li class="faqItem" data-i18n-key="faq1"><b>Q: 是否支持 C++？</b> A: 目前内置 C 语法高亮，打开 .cpp/.hpp 文件会自动切换至 C++ 模式；运行仍通过 C 的 Wandbox 编译器配置，可后续扩展。</li>
  <li class="faqItem" data-i18n-key="faq2"><b>Q: 我的代码会丢失吗？</b> A: 页面会将你的内容保存在浏览器的 localStorage；建议定期“另存为”进行备份。</li>
  <li class="faqItem" data-i18n-key="faq3"><b>Q: WASM 运行器可用吗？</b> A: 当前为预留能力，默认不启用；运行优先 Wandbox，不可用时回退模拟。</li>
  <li class="faqItem" data-i18n-key="faq4"><b>Q: 如何查看历史更新？</b> A: 点击页面右下角“By C. He from ZJU | 版本号”，或在此处打开 <a href="./CHANGELOG.md" target="_blank">CHANGELOG.md</a>。</li>
      </ul>
    </div>

    <div class="section">
  <h2 id="sceneTitle"><i class="fas fa-bullhorn"></i> 适用场景</h2>
      <ul class="list">
  <li class="sceneItem" data-i18n-key="scene1">课堂/培训演示：免安装、跨平台。</li>
  <li class="sceneItem" data-i18n-key="scene2">题解/算法草稿：快速验证小段代码逻辑。</li>
  <li class="sceneItem" data-i18n-key="scene3">示例/文档附带代码：一键运行和复制。</li>
      </ul>
    </div>

    <div class="footer">
  <div class="brand" id="brandFooter">By C. He from ZJU · Online C Compiler</div>
      <div>
        <a href="./index.html" class="btn"><i class="fas fa-arrow-left"></i> 返回编译器</a>
      </div>
    </div>
  </div>

  <button id="themeToggle" class="theme-toggle"><i class="fas fa-moon"></i> 主题</button>
  <button id="langToggle" class="theme-toggle" style="right:160px"><i class="fas fa-globe"></i> EN</button>
  <script>
    const btn = document.getElementById('themeToggle');
    const langBtn = document.getElementById('langToggle');
    const i18n = {
      zh:{
        heroTitle:'在线 C 编译器', heroDesc:'零配置、开箱即用的在线 C 语言编译/运行环境：浏览器中即可编写与运行 C 代码，支持智能自动缩进、美观主题、复制与另存为下载；运行优先调用 Wandbox，若在线失败再回退本地模拟；离线状态将提示不可运行，避免误导。',
        experience:'立即体验', changelog:'查看更新日志', helpBtn:'使用帮助',
        core:'核心特性', coreDesc:'Monaco 编辑器、自动缩进（纯 JS）、撤销/重做、复制、另存为下载、明亮/暗色主题、侧栏输入输出与运行状态显示。',
        indent:'智能缩进', indentDesc:'支持 if/for/while 单行体、do...while、switch/case、字符串/注释/预处理指令，避免常见误缩进。',
        privacy:'数据与隐私', privacyDesc:'编辑内容保存在浏览器本地（localStorage）。另存为将下载到你的设备；提交到 Wandbox 的代码仅用于编译运行。',
        advTitle:'最大优势', adv1:'方便快捷，无需下载，随时可用', adv2:'可以一键复制，方便 OJ 做题提交', adv3:'关闭标签页后代码不会丢失', adv4:'可以一键自动缩进，解决缩进烦恼', adv5:'界面美观，堪称完美，绝对细节', adv6:'安全考量，无需担心代码泄漏',
        moreAdvTitle:'更多优势', madv1:'纯前端 · 零安装：无需登录与插件，打开即用；PWA 支持可安装到桌面，图标为自适应 maskable。', madv2:'离线友好：首次加载后缓存资源；断网仍可编辑与分享，运行会提示不可执行。', madv3:'极速交互：撤销/复制/自动缩进响应迅速。', madv4:'易用细节：文件名脏标记、主题记忆、移动端 I/O 面板、统一动画阴影。', madv5:'可靠最小集：仅运行时才调用远端，不可用回退模拟。', madv6:'可分享与复现：代码压缩进链接，一键还原。',
        helpTitle:'使用帮助', help1:'打开在线编译器，在编辑区域编写 C 代码。', help2:'左侧“输入 (stdin)”填入标准输入（可选）。', help3:'点击“运行”：在线优先 Wandbox；失败回退本地；离线弹窗提示不可运行。', help4:'格式排版用“自动缩进”；复制全部代码用“复制”；下载用“另存为”。', help5:'用“主题”切换明亮/暗色；撤销/重做在可用时自动启用。',
        shortcutTitle:'键盘快捷键', sc1:'运行：Ctrl/Cmd + Enter', sc2:'自动缩进：Ctrl/Cmd + I', sc3:'另存为：Ctrl/Cmd + S', sc4:'切换行注释：Ctrl/Cmd + /', sc5:'命令面板：Ctrl/Cmd + Shift + P（Esc 关闭）',
        shareTitle:'分享与协作', share1:'支持一键分享：代码压缩进链接 (URL hash)，对方打开即还原。', share2:'分享增强：可选包含输入与测试用例，完整复现环境。', share3:'打开分享链接后自动恢复代码及输入/用例。',
        faqTitle:'常见问题（FAQ）', faq1:'Q: 是否支持 C++？ A: 打开 .cpp/.hpp 会启用 C++ 语法高亮；运行暂用 C 编译器。', faq2:'Q: 代码会丢失吗？ A: 保存在 localStorage；建议定期另存为。', faq3:'Q: WASM 运行器可用吗？ A: 预留能力，当前不启用；运行优先 Wandbox。', faq4:'Q: 查看历史更新？ A: 点击底部版本或打开 CHANGELOG.md。',
        sceneTitle:'适用场景', scene1:'课堂/培训演示：免安装、跨平台。', scene2:'题解/算法草稿：快速验证逻辑。', scene3:'示例/文档附代码：一键运行和复制。',
        themeLight:'明亮', themeDark:'暗色', themeLabel:'主题', langToggle:'EN', langToggleZh:'中',
        pageTitle:'在线 C 编译器 · 使用指南与介绍'
      },
      en:{
        heroTitle:'Online C Compiler', heroDesc:'Zero-config, in-browser C environment: edit/run C instantly with smart indentation, themes, copy & save-as. Prefers Wandbox online, falls back to local simulation; offline warns instead of misleading execution.',
        experience:'Try Now', changelog:'Changelog', helpBtn:'Help',
        core:'Core Features', coreDesc:'Monaco editor, pure JS smart indent, undo/redo, copy, save-as download, light/dark theme, sidebar I/O & run status.',
        indent:'Smart Indent', indentDesc:'Handles if/for/while single statements, do...while, switch/case, strings, comments, preprocessors to avoid mis-indents.',
        privacy:'Data & Privacy', privacyDesc:'Code stored locally (localStorage). Save-as downloads file; Wandbox submissions only for compile/run.',
        advTitle:'Key Advantages', adv1:'Fast & ready, no install', adv2:'One-click copy for OJ submissions', adv3:'Code persists after tab close', adv4:'One-click auto indent', adv5:'Polished UI & details', adv6:'Privacy-safe, no upload unless run',
        moreAdvTitle:'More Advantages', madv1:'Pure front-end: zero install; PWA installable with maskable icon.', madv2:'Offline friendly: cached assets allow editing & sharing (run disabled offline).', madv3:'Responsive interactions: undo/copy/indent are instant.', madv4:'Usability details: file dirty mark, theme memory, mobile I/O toggle, consistent animations.', madv5:'Resilient minimal set: remote only when running; fallback simulation on failure.', madv6:'Share & reproduce: code packed into URL hash.',
        helpTitle:'Usage Help', help1:'Open the compiler and write C code.', help2:'Fill left Input (stdin) if needed.', help3:'Click Run: Wandbox first; fallback simulation if online fails; offline shows a warning.', help4:'Use Format for indentation; Copy for all code; Save As to download.', help5:'Use Theme to switch light/dark; undo/redo auto enable when possible.',
        shortcutTitle:'Keyboard Shortcuts', sc1:'Run: Ctrl/Cmd + Enter', sc2:'Format: Ctrl/Cmd + I', sc3:'Save As: Ctrl/Cmd + S', sc4:'Toggle Line Comment: Ctrl/Cmd + /', sc5:'Command Palette: Ctrl/Cmd + Shift + P (Esc close)',
        shareTitle:'Sharing & Collaboration', share1:'One-click share: code compressed into URL hash.', share2:'Enhanced share: optionally include stdin & test cases.', share3:'Opening a share link restores code and inputs/cases.',
        faqTitle:'FAQ', faq1:'Q: C++ supported? A: Opening .cpp/.hpp enables C++ syntax highlighting; runs currently use C compiler.', faq2:'Q: Will code vanish? A: Stored in localStorage; back up with Save As.', faq3:'Q: WASM runner? A: Reserved capability; Wandbox preferred; fallback simulation.', faq4:'Q: View history? A: Click footer version or open CHANGELOG.md.',
        sceneTitle:'Use Cases', scene1:'Classroom/training demos', scene2:'Algorithm scratch/testing', scene3:'Docs/examples with instant run & copy',
        themeLight:'Light', themeDark:'Dark', themeLabel:'Theme', langToggle:'中', langToggleZh:'EN',
        pageTitle:'Online C Compiler · Guide'
      }
    };
    function getLang(){ try{return localStorage.getItem('ui_lang')||'zh';}catch(e){return 'zh';} }
    function setLang(l){ try{ localStorage.setItem('ui_lang', l); }catch(e){} applyLang(); }
    function t(k){ const lang=getLang(); return (i18n[lang]&&i18n[lang][k])||i18n.zh[k]||k; }
    function applyLang(){
      const lang=getLang();
      document.getElementById('pageTitle').textContent=t('pageTitle');
      document.getElementById('heroTitle').innerHTML='<i class="fas fa-code"></i> '+t('heroTitle');
      document.getElementById('heroDesc').textContent=t('heroDesc');
      document.getElementById('ctaExperience').innerHTML='<i class="fas fa-play"></i> '+t('experience');
      document.getElementById('ctaChangelog').innerHTML='<i class="fas fa-book"></i> '+t('changelog');
      document.getElementById('ctaHelp').innerHTML='<i class="fas fa-circle-question"></i> '+t('helpBtn');
      document.querySelector('#cardCore h3').innerHTML='<i class="fas fa-bolt"></i> '+t('core'); document.getElementById('coreDesc').textContent=t('coreDesc');
      document.querySelector('#cardIndent h3').innerHTML='<i class="fas fa-wand-magic-sparkles"></i> '+t('indent'); document.getElementById('indentDesc').textContent=t('indentDesc');
      document.querySelector('#cardPrivacy h3').innerHTML='<i class="fas fa-shield-halved"></i> '+t('privacy'); document.getElementById('privacyDesc').textContent=t('privacyDesc');
      document.getElementById('advTitle').innerHTML='<i class="fas fa-star"></i> '+t('advTitle');
      document.querySelectorAll('.advItem').forEach(li=>{ const k=li.getAttribute('data-i18n-key'); li.textContent=t(k); });
      document.getElementById('moreAdvTitle').innerHTML='<i class="fas fa-gem"></i> '+t('moreAdvTitle');
      document.querySelectorAll('.moreAdvItem').forEach(li=>{ const k=li.getAttribute('data-i18n-key'); li.innerHTML=t(k); });
      document.getElementById('helpTitle').innerHTML='<i class="fas fa-circle-question"></i> '+t('helpTitle');
      document.querySelectorAll('.helpItem').forEach(li=>{ const k=li.getAttribute('data-i18n-key'); li.innerHTML=t(k); });
      document.getElementById('shortcutTitle').innerHTML='<i class="fas fa-keyboard"></i> '+t('shortcutTitle');
      document.querySelectorAll('.shortcutItem').forEach(li=>{ const k=li.getAttribute('data-i18n-key'); li.textContent=t(k); });
      document.getElementById('shareTitle').innerHTML='<i class="fas fa-share-nodes"></i> '+t('shareTitle');
      document.querySelectorAll('.shareItem').forEach(li=>{ const k=li.getAttribute('data-i18n-key'); li.innerHTML=t(k); });
      document.getElementById('faqTitle').innerHTML='<i class="fas fa-list-check"></i> '+t('faqTitle');
      document.querySelectorAll('.faqItem').forEach(li=>{ const k=li.getAttribute('data-i18n-key'); li.innerHTML=t(k); });
      document.getElementById('sceneTitle').innerHTML='<i class="fas fa-bullhorn"></i> '+t('sceneTitle');
      document.querySelectorAll('.sceneItem').forEach(li=>{ const k=li.getAttribute('data-i18n-key'); li.textContent=t(k); });
      // footer brand remains same (branding not localized per requirement)
      // theme button
      try{ btn.innerHTML = (getTheme()==='light'? '<i class="fas fa-moon"></i> '+t('themeLabel')+'('+t('themeDark')+')' : '<i class="fas fa-sun"></i> '+t('themeLabel')+'('+t('themeLight')+')'); }catch(e){}
      if(langBtn) langBtn.innerHTML='<i class="fas fa-globe"></i> '+(lang==='zh'? i18n.zh.langToggle : i18n.en.langToggle);
    }
    langBtn && langBtn.addEventListener('click', ()=>{ const next = getLang()==='zh' ? 'en':'zh'; setLang(next); });
    function getTheme(){
      // 与编译器保持一致：优先使用 editorTheme；兼容旧的 about_theme（一次性迁移）
      try{
        const t = localStorage.getItem('editorTheme');
        if(t){ return t; }
        const legacy = localStorage.getItem('about_theme');
        if(legacy){ localStorage.setItem('editorTheme', legacy==='light'?'light':'dark'); return legacy; }
      }catch(e){}
      return 'dark';
    }
    function applyTheme(){
      const light = getTheme() === 'light';
      document.documentElement.classList.toggle('light', light);
      // defer to applyLang for button text if i18n loaded
      try{ if(typeof applyLang==='function') applyLang(); else btn.innerHTML = light ? '<i class="fas fa-moon"></i> 主题' : '<i class="fas fa-sun"></i> 主题'; }catch(e){}
    }
  applyTheme(); applyLang();
    btn.addEventListener('click', ()=>{
      try{
        const next = (getTheme()==='light') ? 'dark' : 'light';
        localStorage.setItem('editorTheme', next);
        applyTheme();
      }catch(e){}
    });
    // 动态生成 favicon 与 PWA 图标，使用与首页一致的“代码”图形（含缓存与 maskable）
    (function(){
      function drawIcon(size){
        const c = document.createElement('canvas');
        c.width = c.height = size;
        const ctx = c.getContext('2d');
        const r = Math.round(size*0.22);
        const pad = Math.round(size*0.08);
        const w = size, h = size;
        const bg = '#2563eb';
        ctx.fillStyle = bg;
        roundRect(ctx, pad, pad, w-2*pad, h-2*pad, r); ctx.fill();
        ctx.strokeStyle = '#fff'; ctx.lineCap='round'; ctx.lineJoin='round'; ctx.lineWidth = Math.max(2, size*0.09);
        const cx=w/2, cy=h/2, dx=size*0.18, dy=size*0.18;
        ctx.beginPath(); ctx.moveTo(cx-0.06*size, cy-dy); ctx.lineTo(cx-dx, cy); ctx.lineTo(cx-0.06*size, cy+dy); ctx.stroke();
        ctx.beginPath(); ctx.moveTo(cx+0.06*size, cy-dy); ctx.lineTo(cx+dx, cy); ctx.lineTo(cx+0.06*size, cy+dy); ctx.stroke();
        return c;
        function roundRect(ctx,x,y,w,h,r){
          const rr=Math.min(r,w/2,h/2); ctx.beginPath(); ctx.moveTo(x+rr,y); ctx.arcTo(x+w,y,x+w,y+h,rr); ctx.arcTo(x+w,y+h,x,y+h,rr); ctx.arcTo(x,y+h,x,y,rr); ctx.arcTo(x,y,x+w,y,rr); ctx.closePath();
        }
      }
      function setFavicon(url){
        let link = document.querySelector('link[rel="icon"]');
        if(!link){ link=document.createElement('link'); link.rel='icon'; document.head.appendChild(link); }
        link.type='image/png'; link.href=url;
      }
      function updateManifest(icons){
        let m = document.querySelector('link[rel="manifest"]');
        if(!m){ m=document.createElement('link'); m.rel='manifest'; document.head.appendChild(m); }
        const manifest = { name:'在线 C 编译器', short_name:'C编译器', start_url:'./index.html', display:'standalone', background_color:'#0b0c0d', theme_color:'#0b0c0d', lang:'zh-CN', icons:icons };
        const blob = new Blob([JSON.stringify(manifest)], {type:'application/manifest+json'});
        m.href = URL.createObjectURL(blob);
      }
      // 缓存
      const cacheKey = 'dyn_icons_about_v1';
      const cached = localStorage.getItem(cacheKey);
      if (cached) {
        try{
          const data = JSON.parse(cached);
          if (data && data.favicon && data.icons) { setFavicon(data.favicon); updateManifest(data.icons); return; }
        }catch(e){}
      }
      try{
        const sizes = [128,192,256,512];
        const canvases = sizes.map(s=>drawIcon(s));
        Promise.all(canvases.map((c,i)=>new Promise(res=>c.toBlob(b=>res({size:sizes[i],blob:b}), 'image/png')))).then(list=>{
          const urls = list.map(it=>({size:it.size,url:URL.createObjectURL(it.blob)}));
          const fav = urls.find(u=>u.size===192)||urls[0];
          setFavicon(fav.url);
          const icons = urls.map(u=>({src:u.url,sizes:u.size+'x'+u.size,type:'image/png',purpose:(u.size>=256?'any maskable':'any')}));
          updateManifest(icons);
          try{localStorage.setItem(cacheKey, JSON.stringify({favicon:fav.url, icons}));}catch(e){}
        });
      }catch(e){}
    })();
  </script>
</body>
</html>
